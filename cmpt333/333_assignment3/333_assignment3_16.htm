<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-right:0in;
	margin-left:0in;
	font-size:24.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-right:0in;
	margin-left:0in;
	font-size:18.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:#007C41;
	text-decoration:none none;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Times New Roman",serif;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman",serif;
	font-weight:bold;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:"Courier New";}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#007C41" vlink=purple>

<div class=WordSection1>

<p class=MsoNormal align=center style='text-align:center;line-height:normal'><b><span
lang=EN-CA style='font-size:24.0pt;font-family:"Times New Roman",serif'>CMPUT
333, Assignment 3, Fall 2016 </span></b></p>

<p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span lang=EN-CA style='font-size:12.0pt;
font-family:"Times New Roman",serif'>(</span><span lang=EN-CA style='font-size:
10.0pt;font-family:"Times New Roman",serif'>ARP poisoning, buffer overflows</span><span
lang=EN-CA style='font-size:12.0pt;font-family:"Times New Roman",serif'>) </span></p>

<p class=MsoNormal style='line-height:normal'><b><span lang=EN-CA
style='font-size:18.0pt;font-family:"Times New Roman",serif'>ARP Poisoning (60%)</span></b></p>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:normal'><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>The
&quot;backbone&quot; network of the virtual hosts to which you have access, is
the subnet 10.229.100.0/24. Each group's virtual Linux host has one of its
interfaces connected to this subnet. In addition, other hosts are also
connected to this backbone subnet, e.g., hosts used by the TAs for testing
purposes. Among those hosts there are &quot;victim&quot; hosts attached (you
will have to find their IP addresses). Note that what characterizes these
victim hosts as victim hosts is that they are engaged in periodic data
transfers between them, with a period never exceeding the 5 minutes.</span></p>

<h3><span class=Heading3Char><span lang=EN-CA style='font-family:"Times New Roman",serif;
color:windowtext'>Step 1 (20%)</span></span><span lang=EN-CA style='font-size:
10.0pt;line-height:115%;font-weight:normal'> </span></h3>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:normal'><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>Your
first set of tasks is to:</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:1.0in;text-indent:-.25in;
line-height:normal'><span lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>a)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>determine
and report, by using tools such as </span><span lang=EN-CA style='font-size:
10.0pt;font-family:"Courier New"'>nmap</span><span lang=EN-CA style='font-size:
10.0pt;font-family:"Times New Roman",serif'>, etc., what are the IP addresses
of the victim hosts connected to the backbone,</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in;
line-height:normal'><span lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>b)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>determine
and report, using the same/similar tools, what are the services running on each
of the victim hosts connected to the backbone, and,</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in;
line-height:normal'><span lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>c)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>determine
and report the victims' OS and the OS version as accurately as you can (again
using the same assortment of tools).</span></p>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:normal'><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>In your
writeup explaining the above three items, you must also explain what features
probed for by the tool were crucial to identifying it as the particular OS.
This might involve reading a bit more about how the tools work and come up with
their &quot;guesses&quot;. Indicate also which of the victim host(s) is(are)
more difficult to identify their OS and why. The above should be supported by a
corresponding deliverable of the output of the tools that you used and your
findings.</span></p>

<h3><span lang=EN-CA style='font-family:"Times New Roman",serif;color:windowtext'>Step
2 (40%)</span></h3>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:normal'><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>Subsequently,
you will determine which ones are the victim hosts and mount a
man-in-the-middle attack between them to the extent possible. The hint to
follow to find the “victim” hosts is that they are characterized by a fairly
regular communication pattern. As mentioned, they are establishing connections
periodically between them, in the order of minutes. Additionally, the victims
are not the hosts belonging to any of the students groups (i.e., they are not
in the IP address range from 10.229.100.1 to 10.229.100.13) or to the TAs
(10.229.100.96 and 10.229.100.97). Using a man-in-the-middle attack by ARP
poisoning using </span><span lang=EN-CA style='font-size:10.0pt;font-family:
"Courier New"'>ettercap</span><span lang=EN-CA style='font-size:10.0pt;
font-family:"Times New Roman",serif'>:</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:1.0in;text-indent:-.25in;
line-height:normal'><span lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>a)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>determine
the victim hosts, </span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in;
line-height:normal'><span lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>b)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>determine
what connections are initiated (including which one plays the role of the
client, and which one the role of the server for each connection),</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in;
line-height:normal'><span lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>c)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>determine
what is the service(s) to which the connections are established, and,</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in;
line-height:normal'><span lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>d)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>identify
the nature and extract the contents of the transfers between the hosts (not
just a dump of bytes, but qualitatively &quot;what are they about&quot;?).</span></p>

<p class=MsoNormal style='line-height:normal'><span lang=EN-CA
style='font-size:10.0pt;font-family:"Times New Roman",serif'>The above should
be supported by a corresponding deliverable of </span><span lang=EN-CA
style='font-size:10.0pt;font-family:"Courier New"'>tcpdump</span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'> packet
trace and any contents that you intercepted. Specifically, your deliverable
should include at least (i) the ARP activity spanning the time period just
before and just after you performed ARP poisoning, (ii) captured packets of the
communication between the hosts (if many, then a compressed archive of the
packet capture), (iii) any contents (packet payload, e.g., files) that you were
able to reconstruct from the communication between the victims, and (iv) the
output you got from </span><span lang=EN-CA style='font-size:10.0pt;font-family:
"Courier New"'>ettercap</span><span lang=EN-CA style='font-size:10.0pt;
font-family:"Times New Roman",serif'>.</span></p>

<p class=MsoNormal style='line-height:normal'><span lang=EN-CA
style='font-size:10.0pt;font-family:"Times New Roman",serif'>Notice, you may
see also non-ARP activity in your </span><span lang=EN-CA style='font-size:
10.0pt;font-family:"Courier New"'>tcpdump</span><span lang=EN-CA
style='font-size:10.0pt;font-family:"Times New Roman",serif'> output, including
possibly of hosts not on the same 10.229.100.0/24 network. That's fine, you
should not remove this additional traffic from your </span><span lang=EN-CA
style='font-size:10.0pt;font-family:"Courier New"'>tcpdump</span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'> trace.</span></p>

<p class=MsoNormal style='line-height:normal'><span lang=EN-CA
style='font-size:10.0pt;font-family:"Times New Roman",serif'>To complete this
task you need to read and understand the </span><span lang=EN-CA
style='font-size:10.0pt;font-family:"Courier New"'>ettercap</span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'> manual
page (</span><span lang=EN-CA style='font-size:10.0pt;font-family:"Courier New"'>man</span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'> </span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Courier New"'>ettercap</span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>) on
your virtual Linux host. Please compress your submission as the files involved
can be quite large. </span></p>

<h2><span lang=EN-CA>Buffer Overflows (40%)</span></h2>

<p style='margin:0in;margin-bottom:.0001pt'><span lang=EN-CA style='font-size:
10.0pt'>You are given an executable file (filename: </span><span lang=EN-CA
style='font-size:10.0pt;font-family:"Courier New"'><a href="weak">weak</a></span><span lang=EN-CA
style='font-size:10.0pt'>) which performs a trivial transformation on input
provided from </span><span lang=EN-CA style='font-size:10.0pt;font-family:"Courier New"'>stdin</span><span
lang=EN-CA style='font-size:10.0pt'>. The executable is runable on your Linux
virtual host. The program requires one command line argument (it can be a name,
like “joe” or “bob”) when you invoke it. The rest of the interaction with the
program is through the stdin/stdout. You also know that the executable contains
a function that prints the string “Magic cookie found!”. Your task is to write
a buffer overflow exploit that, when used, forces the program to print
&quot;Magic cookie found!”. To complete this part you must:</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span lang=EN-CA style='font-size:
10.0pt'>&nbsp;</span></p>

<p style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:1.0in;
margin-bottom:.0001pt;text-indent:-.25in'><span lang=EN-CA style='font-size:
10.0pt'>a)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-CA style='font-size:10.0pt'>report what is it that
program actually does (it is quite trivial -- don't go overboard here)</span></p>

<p style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:1.0in;
margin-bottom:.0001pt;text-indent:-.25in'><span lang=EN-CA style='font-size:
10.0pt'>b)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-CA style='font-size:10.0pt'>report what is the
buffer size used by the program and how you found that out</span></p>

<p style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:1.0in;
margin-bottom:.0001pt;text-indent:-.25in'><span lang=EN-CA style='font-size:
10.0pt'>c)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-CA style='font-size:10.0pt'>report how you
determined how to call the function that produced the desirable output </span></p>

<p style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:1.0in;
margin-bottom:.0001pt;text-indent:-.25in'><span lang=EN-CA style='font-size:
10.0pt'>d)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-CA style='font-size:10.0pt'>provide the source code
for your exploit </span></p>

<p style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:1.0in;
margin-bottom:.0001pt;text-indent:-.25in'><span lang=EN-CA style='font-size:
10.0pt'>e)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-CA style='font-size:10.0pt'>report how your exploit
works and why it is structured the way it is</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span lang=EN-CA style='font-size:
10.0pt'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span lang=EN-CA style='font-size:
10.0pt'>In addition you have to pick one of the following two to do
additionally:</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span lang=EN-CA style='font-size:
10.0pt'>&nbsp;</span></p>

<p style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:1.0in;
margin-bottom:.0001pt;text-indent:-.25in'><span lang=EN-CA style='font-size:
10.0pt'>f)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-CA style='font-size:10.0pt'>either, explain how to
write the exploit in a way that the program does not terminate abnormally
(i.e., the program exits), or,</span></p>

<p style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:1.0in;
margin-bottom:.0001pt;text-indent:-.25in'><span lang=EN-CA style='font-size:
10.0pt'>g)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-CA style='font-size:10.0pt'>find another
vulnerability in the program that involves </span><span lang=EN-CA
style='font-size:10.0pt;font-family:"Courier New"'>printf</span><span
lang=EN-CA style='font-size:10.0pt'> formatting strings</span></p>

<p class=MsoNormal style='line-height:normal'><span lang=EN-CA
style='font-size:10.0pt;font-family:"Times New Roman",serif'>Note that you
should try to write the exploit in a way such that, after it prints </span><span
lang=EN-CA style='font-size:10.0pt;font-family:"Times New Roman",serif'>&quot;Magic
cookie found!”, </span><span lang=EN-CA style='font-size:10.0pt;font-family:
"Times New Roman",serif'>the program terminates as normally as possible (i.e., preferably
without aborting or crashing to receive full marks). </span></p>

<p class=MsoNormal style='line-height:normal'><b><span lang=EN-CA
style='font-size:18.0pt;font-family:"Times New Roman",serif'>Deliverables</span></b></p>

<p class=MsoNormal style='line-height:normal'><span lang=EN-CA
style='font-size:10.0pt;font-family:"Times New Roman",serif'>Only one of the
group members need to submit on behalf of the entire group (in the event of
more than one submission, the last one will be considered). Your report should
include answers to the questions and should cite any resources that you used to
answer the questions. By default it is assumed that all group members
contribute equally to the assignment. If you need to deviate from this model of
cooperation, explain why and indicate who was responsible for what.</span></p>

<p style='background:white'><span lang=EN-CA style='font-size:10.0pt'>[Optional:
add a single paragraph at the end of the report indicating whether you found
any difficulties with this assignment and if you think there are ways in which
it could be improved. In particular, we are interested to know if the
assignment forced you to learn something new that you did not know of before,
and how much effort it took you. Was the workload reasonable?]</span></p>

<p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span lang=EN-CA style='font-size:12.0pt;
font-family:"Times New Roman",serif'>*************** </span></p>

<p class=MsoNormal><span lang=EN-CA>&nbsp;</span></p>

</div>

</body>

</html>
